(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.MentionCompleter=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function replaceMatch(string,replaceStart,replaceEnd,replaceWith){var start=string.substr(0,replaceStart);var end=string.substr(replaceEnd);var cursorPosition=start.length+replaceWith.length+1;return{text:start+replaceWith+" "+end,selectionRange:{start:cursorPosition,end:cursorPosition}}}module.exports=replaceMatch},{}],2:[function(require,module,exports){"use strict";function detectMatch(string,selectionStart,selectionEnd,patterns){var part,match;if(selectionStart!==selectionEnd)return null;part=string.substr(0,selectionEnd+1);if(part.length<=selectionEnd){part+=" "}for(var patternName in patterns){if(patterns.hasOwnProperty(patternName)){var pattern=patterns[patternName];var re=new RegExp(pattern.source+".$");if(match=part.match(re)){return{string:string,value:match[1],type:patternName,range:{start:match.index,end:match.index+match[1].length}}}}}return null}module.exports=detectMatch},{}],3:[function(require,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}throw TypeError('Uncaught, unspecified "error" event.')}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];handler.apply(this,args)}}else if(isObject(handler)){len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){var m;if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i=length;i-->0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners)}else{while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.listenerCount=function(emitter,type){var ret;if(!emitter._events||!emitter._events[type])ret=0;else if(isFunction(emitter._events[type]))ret=1;else ret=emitter._events[type].length;return ret};function isFunction(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}],4:[function(require,module,exports){"use strict";var EventEmitter=require("events").EventEmitter;var detectMatch=require("./lib/detect-match");var computeReplacement=require("./lib/compute-replacement");function MentionCompleter(options){EventEmitter.call(this);this.patterns=options.patterns;this.getSelectionRange=options.getSelectionRange;this.setSelectionRange=options.setSelectionRange;this.getValue=options.getValue;this.setValue=options.setValue;this.mostRecentMatch=null;this.on("replace",function(replacement){this._setValueAsync(replacement.text);this._setSelectionRangeAsync(replacement.selectionRange)});this.on("check",function(state){this.mostRecentMatch=detectMatch(state.value,state.range.start,state.range.end,this.patterns);if(this.mostRecentMatch){this.emit("match",this.mostRecentMatch)}else{this.emit("nomatch")}}.bind(this))}MentionCompleter.prototype=Object.create(EventEmitter.prototype);MentionCompleter.prototype._error=function(msg){this.emit("error",msg)};MentionCompleter.prototype._getSelectionRangeAsync=function(cb){if(this.getSelectionRange){this.getSelectionRange(cb)}else{this._error("Error: MentionCompleter: getSelectionRange( function(err,range) ) must be provided")}};MentionCompleter.prototype._setSelectionRangeAsync=function(range,cb){if(this.setSelectionRange){this.setSelectionRange(range,cb)}};MentionCompleter.prototype._getValueAsync=function(cb){if(this.getValue){this.getValue(cb)}else{this._error("Error: MentionCompleter: getValue( function(err,value) ) must be provided")}};MentionCompleter.prototype._setValueAsync=function(value){if(this.setValue){this.setValue(value)}};MentionCompleter.prototype.checkForMatch=function(){this._getSelectionRangeAsync(function(err,range){if(err){this._error("Error: MentionCompleter: failed to query selection range")}else{this._getValueAsync(function(err,value){if(err){this._error("Error: MentionCompleter: failed to query input value")}else{this.emit("check",{value:value,range:range})}}.bind(this))}}.bind(this));return this};MentionCompleter.prototype.replaceMatch=function(match,text){if(match){var replacement=computeReplacement(match.string,match.range.start,match.range.end,text);this.emit("replace",replacement)}else{this._error("Match is invalid:",match)}return this};module.exports=MentionCompleter},{"./lib/compute-replacement":1,"./lib/detect-match":2,events:3}]},{},[4])(4)});
